<!DOCTYPE html>\n<html>\n<head>\n    <meta charset=\"UTF-8\">\n    <title><\/title>\n    <!-- 引入样式 -->\n\n    <link rel=\"stylesheet\" href=\"\/static\/plugins\/vue\/index.css\">\n    <!-- import Vue before Element -->\n    <script src=\"\/static\/plugins\/vue\/vue.js\"><\/script>\n    <!-- import JavaScript -->\n    <script src=\"\/static\/plugins\/vue\/index.js\"><\/script>\n    <!-- axios -->\n    <script src=\"\/static\/plugins\/vue\/axios.min.js\"><\/script>\n<\/head>\n<body>\n\n<div id=\"app\">\n\n        <el-row :gutter=\"20\">\n            <el-form @submit.native.prevent :inline=\"true\" size=\"small\" class=\"demo-form-inline\">\n                <el-col :span=\"16\">\n\n                        <el-form-item>\n                            <el-input v-model=\"searchForm.title\" placeholder=\"title\"><\/el-input>\n                        <\/el-form-item>\n\n                        <el-form-item>\n                            <el-button type=\"primary\" @click=\"search\">搜索<\/el-button>\n                        <\/el-form-item>\n\n                <\/el-col>\n                <el-col :span=\"8\">\n                    <el-form-item style=\"float: right\">\n                    <el-button type=\"success\" icon=\"el-icon-plus\" @click=\"showAdd\">新增<\/el-button>\n                    <\/el-form-item>\n                <\/el-col>\n            <\/el-form>\n        <\/el-row>\n\n        <el-table\n                @row-dblclick=\"dbclick\"\n                :data=\"tableData\"\n                border\n                stripe\n                height=\"500\"\n                size=\"small\"\n                style=\"width: 100%\"\n                show-overflow-tooltip>\n            <el-table-column prop=\"article_id\" label=\"文章ID\" width=\"80\"><\/el-table-column>\n            <el-table-column prop=\"add_time\" label=\"新增时间\" width=\"180\"><\/el-table-column>\n            <el-table-column prop=\"title\" label=\"title\" width=\"680\" show-overflow-tooltip>\n                <template scope=\"scope\">\n                    <div>\n                        {{ scope.row.title}}\n                    <\/div>\n                <\/template>\n            <\/el-table-column>\n            \n            \n            <el-table-column\n                    align=\"center\"\n                    fixed=\"right\"\n                    label=\"操作\"\n                    width=\"100\">\n                <template slot-scope=\"scope\">\n                    <el-link type=\"primary\" @click=\"one(scope)\">编辑<\/el-link>\n                    <el-link type=\"danger\" @click=\"del(scope)\">删除<\/el-link>\n                <\/template>\n            <\/el-table-column>\n        <\/el-table>\n        <el-pagination\n                background\n                :page-sizes=\"[30, 60, 100, 200]\"\n                layout=\"total, sizes, prev, pager, next, jumper\"\n                :total=\"total\" :page-size=\"limit\"\n                @current-change=\"change\"\n        >\n        <\/el-pagination>\n\n    <el-dialog :title=\"dialogFormTitle\" :visible.sync=\"dialogFormVisible\" :fullscreen=\"true\">\n        \n            \n             \n        <iframe :src=\"iframeUrl\" frameborder=\"0\" width=\"100%\" height=\"500\"><\/iframe>\n\n<!--        <div slot=\"footer\" class=\"dialog-footer\">\n            <el-button @click=\"dialogFormVisible = false\">取消<\/el-button>\n            <el-button type=\"primary\" :loading=\"loadBtn\" @click=\"confirm\">确定<\/el-button>\n        <\/div>-->\n    <\/el-dialog>\n<\/div>\n<script src=\"\/static\/js\/http.js\"><\/script>\n<script>\n    \n    const url = \"\/manager\/articlelist\"\n    var app1 = new Vue({\n        el: '#app',\n        data: {\n            tableData: [],\n            category: [],\n            total: 4,\n            limit: 30,\n            page: 1,\n            searchForm: {\n                goods_name: '',\n            },\n            dialogFormVisible: false,\n            form: {\n                goods_name: '',\n                goods_id: '',\n                collection_url: '',\n            },\n            goods_id: '',\n            dialogFormTitle: '',\n            loadBtn: false,\n            isenabled: false,\n            suningLoad: false,\n            iframeUrl: '',\n        },\n        created() {\n            this.testList()\n            this.categoryList()\n        },\n        methods: {\n            search(){\n                this.testList()\n            },\n            change(page){\n                this.page = page\n                this.testList()\n            },\n            categoryList() {\n                this.loading = true\n                http.post(\"\/manager\/categoryList\",{\n                    ccOption: 'list',\n                    category_name: '',\n                    page: this.page,\n                    limit: this.limit,\n                }).then(res => {\n                    let d = res.data.data\n                    this.category = d.items\n                })\n            },\n            getSuningGoods() {\n                \/\/console.log(this.form.collection_url);\n                if(this.form.collection_url == '')\n                {\n                    return this.$message.error(\"采集连接不能为空\");\n                }\n                this.suningLoad = true\n                http.post(url,{\n                    ...this.form,\n                    ccOption: 'suning',\n                    \n                }).then(res => {\n                    let d = res.data.data\n                    this.form.goods_name = d.goods_name\n                    this.form.goods_image_small = d.goods_image_small\n                    this.form.goods_image_big = d.goods_image_big\n                    this.form.goods_desc = d.goods_desc\n                    this.form.color = d.color\n                    this.form.version = d.version\n                    this.suningLoad = false\n                })\n            },\n            testList() {\n                http.post(url,{\n                    page: this.page,\n                    limit: this.limit,\n                    goods_name: this.searchForm.goods_name,\n                    ccOption: 'list'\n                }).then(res => {\n                    let d = res.data.data\n                    this.size = d.limit\n                    this.total = d.total\n                    this.tableData = d.items\n                })\n            },\n            showAdd() {\n                this.resetForm()\n                this.dialogFormTitle = \"新增\",\n                this.dialogFormVisible = true\n                this.isenabled = false\n                this.iframeUrl = \"\/manager\/articleadd\";\n            },\n            confirm() {\n                if(this.form.goods_id == '')\n                {\n                    this.add()\n                }\n                else\n                {\n                    this.edit()\n                }\n            },\n            add() {\n                this.loadBtn = true\n                let newFormData = {...this.form,ccOption: 'add',goods_id: this.goods_id}\n                http.post(url,newFormData).then(res => {\n                    this.loadBtn = false\n                    if(res.data.code == 0)\n                    {\n                        this.$message.success(\"操作成功\")\n                        this.dialogFormVisible = false\n                        this.testList()\n                    }\n                    else\n                    {\n                        this.$message.error(res.data.message);\n                    }\n\n                })\n            },\n            edit() {\n                this.loadBtn = true\n                \n                let newFormData = {...this.form,ccOption: 'edit'}\n                http.post(url,newFormData).then(res => {\n                    this.loadBtn = false\n                    if(res.data.code == 0)\n                    {\n                        this.$message.success(\"操作成功\")\n                        this.dialogFormVisible = false\n                        this.testList()\n                    }\n                    else\n                    {\n                        this.$message.error(res.data.message);\n                    }\n                })\n            },\n            one(scope) {\n                this.dialogFormTitle = \"编辑\"\n                http.post(url,{\n                    goods_id: scope.row.goods_id,\n                    ccOption: 'one'\n                }).then(res => {\n                    this.form = res.data.data\n                    console.log(this.form)\n                })\n                this.isenabled = true\n                this.dialogFormVisible = true;\n            },\n            resetForm() {\n                this.form = {\n                    goods_name: '',\n                    goods_id: '',\n                    collection_url: ''\n                }\n            },\n            del(scope) {\n                this.$confirm(\"此操作将永久删除, 是否继续?\", \"提示\", {\n                    confirmButtonText: \"确定\",\n                    cancelButtonText: \"取消\",\n                    type: 'warning'\n                }).then(() => {\n                    http.post(url,{\n                        goods_id: scope.row.goods_id,\n                        ccOption: 'del'\n                    }).then(res => {\n                        if(res.data.code == 0) {\n                            this.$message.success(\"操作成功\");\n                            this.testList()\n                        }\n                        else\n                        {\n                            this.$message.error(res.data.message);\n                        }\n                    })\n\n                }).catch(() => {\n\n                });\n            },\n            dbclick(row, column, event) {\n                \/\/console.log(row.goods_id)\n            }\n        }\n    })\n\n    \n<\/script>\n<style>\n.el-table th>.cell{\n        display: inline-block;\n        white-space: nowrap;\n        word-break: keep-all;\n        text-overflow: unset;\n}\n\n.el-dialog__body{padding: 0px 20px !important}\n<\/style>\n\n<style>\n    .el-pagination{margin-left:-10px;padding-top: 15px}\n    body{padding:10px}\n    .el-date-editor.el-input, .el-date-editor.el-input__inner{width:auto !important}\n    #date{padding-right: 0px}\n<\/style>\n<\/body>\n<\/html>